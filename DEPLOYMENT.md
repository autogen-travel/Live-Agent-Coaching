# Инструкция по развертыванию

## Настройка API ключей на сервере

### 1. Обновите код на сервере
```bash
cd ~/Dasha
git pull origin main
```

### 2. Создайте новый API ключ OpenAI
1. Перейдите на https://platform.openai.com/account/api-keys
2. Создайте новый API ключ
3. Скопируйте его

### 3. Настройте переменные окружения на сервере

#### Рекомендуемый способ: Использование .env файла
```bash
# Скопируйте пример конфигурации
cp config.example .env

# Отредактируйте .env файл и замените значения на реальные
nano .env
```

Содержимое файла `.env`:
```bash
# OpenAI API Configuration
OPENAI_API_KEY=your_new_api_key_here

# Dasha Configuration
DASHA_ENDPOINT=your_dasha_endpoint_here
DASHA_API_KEY=your_dasha_api_key_here
```

#### Альтернативный способ: Переменные окружения
```bash
export OPENAI_API_KEY=your_new_api_key_here
```

### 4. Перезапустите приложение

#### Способ 1: Использование скрипта (рекомендуется)
```bash
# Используйте готовый скрипт для правильной настройки
./setup-env.sh
```

#### Способ 2: Подключение к развернутому приложению (рекомендуется)
```bash
# Сначала разверните приложение
dasha app deploy app

# Затем подключитесь к развернутому приложению
node index-connect.js
```

#### Способ 3: Ручная настройка
```bash
# Очистите существующие переменные окружения
unset OPENAI_API_KEY
unset DASHA_API_KEY
unset DASHA_ENDPOINT

# Загрузите переменные из .env файла
export $(cat .env | grep -v '^#' | xargs)

# Запустите приложение
node index.js
```

#### Способ 4: Альтернативная версия (если основной не работает)
```bash
# Используйте альтернативную версию с дополнительными параметрами
node index-alternative.js
```

### 5. Проверьте, что API ключ работает
```bash
# Проверьте переменную окружения
echo $OPENAI_API_KEY
```

## Важные моменты:

- **Никогда не храните API ключи в коде**
- **Используйте переменные окружения**
- **Регулярно обновляйте API ключи**
- **Мониторьте использование API ключей**

## Устранение неполадок:

Если получаете ошибку "Incorrect API key":
1. Проверьте, что переменная окружения установлена: `echo $OPENAI_API_KEY`
2. Убедитесь, что API ключ действителен
3. Проверьте, что у вас есть доступ к GPT-5
4. Перезапустите приложение после изменения переменных окружения
